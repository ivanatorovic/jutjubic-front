<!-- upload.component.html -->
<div class="page">
  <!-- Top bar -->
  <header class="topbar">
    <a class="brand" routerLink="/videos" aria-label="jutjubic home">
      <span class="logo">‚ñ∂</span>
      <span class="name">jutjubic</span>
    </a>
  </header>

  <main class="content">
    <div class="card">
      <div class="header">
        <div>
          <h1>Upload videa</h1>
          <p>Naslov, opis, tagovi, lokacija i fajlovi.</p>
        </div>

        <button
          class="btn primary big"
          (click)="upload()"
          [disabled]="
            uploading ||
            !thumbnailFile ||
            !videoFile ||
            !title.trim() ||
            !description.trim() ||
            !tags.trim()
          "
        >
          <span *ngIf="!uploading">Upload</span>
          <span *ngIf="uploading" class="spin"></span>
          <span *ngIf="uploading">Uploading‚Ä¶</span>
        </button>
      </div>

      <div class="grid">
        <!-- LEVO -->
        <section class="panel">
          <div class="field">
            <label>Naslov</label>
            <input [(ngModel)]="title" type="text" placeholder="npr. Moj prvi video" />
          </div>

          <div class="field">
            <label>Opis</label>
            <textarea [(ngModel)]="description" placeholder="Kratak opis videa..."></textarea>
          </div>

          <div class="grid-2">
            <div class="field">
              <label>Lokacija</label>
              <input [(ngModel)]="location" type="text" placeholder="npr. Novi Sad" />
            </div>

            <div class="field">
              <label>Tagovi</label>
              <input [(ngModel)]="tags" type="text" placeholder="npr. fun, vlog, isa" />

              <div class="hint">
                Primer: <span class="chip">#fun</span> <span class="chip">#vlog</span>
              </div>

              <div class="tags-preview" *ngIf="tagsList().length">
                <span class="tchip" *ngFor="let t of tagsList()">{{ t }}</span>
              </div>
            </div>
          </div>

          <div class="status-line" *ngIf="msg">
            <span class="status" [class.ok]="msg.includes('‚úÖ')" [class.bad]="msg.includes('‚ùå')">
              {{ msg }}
            </span>
          </div>
        </section>

        <!-- DESNO -->
        <section class="panel files">
          <!-- THUMB -->
          <div class="file-card">
            <div class="file-head">
              <div>
                <div class="file-title">Thumbnail</div>
                <div class="file-sub">JPG / PNG</div>
              </div>

              <input
                #thumbInput
                class="hidden-input"
                type="file"
                accept="image/*"
                (change)="onThumbnailChange($event)"
              />
              <button class="pick" type="button" (click)="thumbInput.click()">
                Izaberi
              </button>
            </div>

            <div class="file-name" [class.muted]="!thumbnailFile">
              {{ thumbnailFile?.name || 'Nije izabrano' }}
            </div>

            <div class="file-meta" *ngIf="thumbnailFile">
              <span>{{ formatBytes(thumbnailFile.size) }}</span>
              <button type="button" class="mini-x" (click)="clearThumb($event)">‚úï</button>
            </div>

            <div class="thumb-preview" *ngIf="thumbnailPreviewUrl; else thumbEmpty">
              <img [src]="thumbnailPreviewUrl" alt="thumbnail preview" />
            </div>

            <ng-template #thumbEmpty>
              <div class="thumb-empty">
                <div class="thumb-empty-icon">üñºÔ∏è</div>
                <div class="thumb-empty-text">Izaberi thumbnail da vidi≈° preview</div>
                <div class="thumb-empty-sub">Preporuka: 16:9, JPG/PNG</div>
              </div>
            </ng-template>
          </div>

          <!-- VIDEO -->
          <div class="file-card">
            <div class="file-head">
              <div>
                <div class="file-title">Video</div>
                <div class="file-sub">MP4</div>
              </div>

              <input
                #videoInput
                class="hidden-input"
                type="file"
                accept="video/*"
                (change)="onVideoChange($event)"
              />
              <button class="pick" type="button" (click)="videoInput.click()">
                Izaberi
              </button>
            </div>

            <div class="file-name" [class.muted]="!videoFile">
              {{ videoFile?.name || 'Nije izabrano' }}
            </div>

            <div class="file-meta" *ngIf="videoFile">
              <span>{{ formatBytes(videoFile.size) }}</span>
              <button type="button" class="mini-x" (click)="clearVideo($event)">‚úï</button>
            </div>

            <div class="mini-hint">
              Savet: manji fajl = br≈æi upload.
            </div>
          </div>
        </section>
      </div>
    </div>
  </main>
</div>
