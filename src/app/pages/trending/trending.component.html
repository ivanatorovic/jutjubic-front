<div class="page">
  <header class="topbar">
    <a class="brand" routerLink="/videos" aria-label="jutjubic home">
      <span class="logo">â–¶</span>
      <span class="name">jutjubic</span>
    </a>

    <div class="top-actions">
      <ng-container *ngIf="!isLoggedIn(); else logged">
        <button class="btn ghost" routerLink="/login">Prijava</button>
        <button class="btn primary" routerLink="/register">Registracija</button>
      </ng-container>

      <ng-template #logged>
        <button class="btn ghost" routerLink="/upload">Upload</button>

        <button
          class="btn ghost"
          *ngIf="currentUserId !== null"
          [routerLink]="['/user-profile', currentUserId]"
        >
          Profil
        </button>

        <button class="btn primary" (click)="logout()">Logout</button>
      </ng-template>
    </div>
  </header>

  <div class="hero-row">
    <h1 class="hero-title">Najpopularniji videi u vaÅ¡oj okolini!</h1>

    <div class="radius-wrap">
      <label class="radius-label" for="radius">Radijus</label>
      <select
        id="radius"
        class="radius-select"
        [(ngModel)]="radiusKm"
        (change)="onRadiusChange()"
        [disabled]="loading"
      >
        <option *ngFor="let r of radiusOptions" [ngValue]="r">{{ r }} km</option>
      </select>
    </div>
  </div>

  <div *ngIf="loading" class="state">UÄitavam trending videe...</div>
  <div *ngIf="!loading && error" class="state error">{{ error }}</div>

  <div class="list" *ngIf="!loading && !error">
   <div
      class="row"
      *ngFor="let v of trending; let i = index"
      [ngClass]="'rank-' + (i + 1)"
    >
    <div class="rank">#{{ i + 1 }}</div>

    <article
      class="card"
      (click)="openWatch(v.id)"
      role="button"
      tabindex="0"
      (keydown.enter)="openWatch(v.id)"
      (keydown.space)="openWatch(v.id)"
    >
      <div class="thumb-wrap">
        <img class="thumb" [src]="videoService.thumbnailUrl(v.id)" alt="thumbnail" />
        <div class="play-overlay">â–¶</div>
      </div>

      <div class="info">
        <div class="title" [title]="v.title">{{ v.title }}</div>

        <div class="sub">
          <span
            class="user"
            (click)="openUser(v.userId, $event)"
            role="link"
            tabindex="0"
            (keydown.enter)="openUser(v.userId, $event)"
          >
            <span class="avatar">
              {{ (v.username ?? '?').slice(0, 1).toUpperCase() }}
            </span>
            <span class="uname">{{ v.username ?? 'Nepoznat autor' }}</span>
          </span>

          <span class="dot">â€¢</span>
          <span class="time">{{ formatTime(v.createdAt) }}</span>

          <div class="location" *ngIf="v.location && v.location.trim()">ğŸ“ {{ v.location }}</div>
        </div>

        <div class="stats">
          <span class="chip">ğŸ‘ï¸ {{ v.viewCount ?? 0 }}</span>
          <span class="chip">ğŸ‘ {{ v.likeCount ?? 0 }}</span>
          <span class="chip">ğŸ’¬ {{ v.commentCount ?? 0 }}</span>
        </div>
      </div>
    </article>
  </div>

  <div *ngIf="trending.length === 0" class="state">Nema trending videa u vaÅ¡oj blizini.</div>
</div>


   
</div>
